#Add SharePoint PowerShell Snapin which adds SharePoint specific cmdlets
Add-PSSnapin Microsoft.SharePoint.PowerShell -EA SilentlyContinue
 
# Script settings
$webUrl = "https://spwfe.contoso.local"
$listName = "List #2"
$numberItemsToCreate = 100
$itemNamePrefix = "Item - "
$attachmentPath = "C:\Path\To\Your\Attachment\File.txt" # Change this to the path of your attachment file
 
# Open web and library
$web = Get-SPWeb $webUrl
$list = $web.Lists[$listName]
 
# Create desired number of items in subfolder
for($i=1; $i -le $numberItemsToCreate; $i++)
{
    $newItemSuffix = $i.ToString("00000")
    $newItem = $list.AddItem()
    $newItem["Title"] = "$itemNamePrefix$newItemSuffix"
    
    # Attach a file to the item
    $attachmentFile = Get-Item $attachmentPath
    $attachmentBytes = [System.IO.File]::ReadAllBytes($attachmentFile.FullName)
    $attachment = $newItem.Attachments.Add([System.IO.Path]::GetFileName($attachmentFile.FullName), $attachmentBytes)
    
    $newItem.Update()
    Write-Host "Item created: $itemNamePrefix$newItemSuffix with attachment: $($attachment.FileName)"
}

# Dispose web
$web.Dispose()
